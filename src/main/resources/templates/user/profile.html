<!DOCTYPE html>
<html lang="ko">
<th:block th:replace="~{includes/user/head}" />
<style>
    .main-container {
        background-color: #F9FAFB;
        margin: 0 auto;
        min-height: 100vh;
        position: relative;
    }
    /* Header */
    .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        /*padding: 8px 12px;*/
        background: white;
        border-bottom: 1px solid #e5e5e5;
    }
</style>
<style>
    .points-section {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .point-item {
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .p-icon {
        width: 24px;
        height: 24px;
        background: linear-gradient(135deg, #4285F4, #1976D2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 12px;
    }

    .ticket-icon {
        color: #9C27B0;
        font-size: 18px;
    }

    .point-text {
        color: #4285F4;
        font-weight: 600;
        font-size: 14px;
    }

    .ct-text {
        color: #9C27B0;
        font-weight: 600;
        font-size: 14px;
    }

    .prediction-card {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }

    .vote-ticket-btn {
        background: linear-gradient(135deg, #4285F4, #9C27B0);
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(66, 133, 244, 0.3);
    }

    .vote-ticket-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(66, 133, 244, 0.4);
    }

    .vote-button {
        background: linear-gradient(90deg, #8FCCFF 0%, #E0E7FF 25%, #F9EBFF 75%, #E7B0FF 100%);
        border-radius: 12px;
        padding: 8px;
        display: flex;
        justify-content: space-between;
        margin: 16px 0;
    }

    .yes-option {
        color: #1D8EFF;
        font-weight: 700;
    }

    .no-option {
        color: #B100FF;
        font-weight: 700;
    }

    .participate-button {
        background: #3B82F6;
        color: white;
        width: 100%;
        padding: 12px 0;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        border: none;
    }

    .timer {
        color: #6B7280;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        font-weight: 700;
        margin-left: auto;
    }

    .bts-image {
        width: 72px;
        height: 72px;
        border-radius: 8px;
        background: linear-gradient(45deg, #1a1a1a, #333);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
        margin-right: 12px;
    }

    .p-icon {
        background: #3B82F6;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
    }

    .ticket-icon {
        color: #8B5CF6;
        font-size: 16px;
    }

    .banner-bg {
        background-color: #EAF3FE;
    }
    .banner-text-title {
        color: #50A7FE;
    }
    .banner-text-content {
        color: #6B7583;
    }

    .popup {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        width: 90%;
        max-width: 400px;
    }

    .gradient-btn {
        background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
        color: white;
        border: none;
        border-radius: 8px;
        padding: 8px 16px;
        font-size: 14px;
        font-weight: 500;
    }

    .p-icon {
        background: #3b82f6;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
    }

    .ticket-icon {
        color: #8b5cf6;
        font-size: 16px;
    }

    .yes-btn {
        background: #e5f3ff;
        color: #1e40af;
        border: 1px solid #3b82f6;
        border-radius: 6px;
        padding: 6px 16px;
        font-size: 14px;
        font-weight: 500;
    }

    .quantity-input {
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 8px 12px;
        width: 80px;
        text-align: center;
        font-size: 14px;
    }

    .slider {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: #e5e7eb;
        outline: none;
    }

    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #3b82f6;
        cursor: pointer;
        border: 2px solid white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .slider::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #3b82f6;
        cursor: pointer;
        border: 2px solid white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .slider.purple::-webkit-slider-thumb {
        background: #8b5cf6;
    }

    .slider.purple::-moz-range-thumb {
        background: #8b5cf6;
    }

    .cancel-btn {
        background: #f3f4f6;
        color: #6b7280;
        border: none;
        border-radius: 8px;
        padding: 12px 24px;
        font-size: 16px;
        font-weight: 500;
        flex: 1;
    }

    .participate-btn {
        background: #3b82f6;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 12px 24px;
        font-size: 16px;
        font-weight: 500;
        flex: 1;
    }

    .reward-text {
        color: #059669;
        font-weight: 600;
        font-size: 16px;
    }

    .div_circle {
        width: 80px;
        height: 80px;
        margin: 0 auto;
        border-radius: 50%;
        background: #F9F9F9;
        border: 2px solid #E8EAEE;
    }
    .span_text_box {
        padding : 4px 10px 6px 10px;
        font-size: large;
    }
    .font_color_lightblue {
        color: #1D8EFF;
    }
    .font_color_pink {
        color: #BB20FF;
    }
    .btn_mypoint {
        background-color: #EAF3FE;
    }
    .btn_vote_continue {
        background-color: #2D35F8;
    }
    .text_description {
        font-size: 10px;
    }

    .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    .btn-primary:hover {
        background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
    }
    .btn_show_guide {
        border: 1px solid #C1C4C9;
    }

    .prediction-item {
        transition: all 0.2s ease;
    }
    .prediction-item:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .tab-active {
        color: #3b82f6;
        border-bottom: 2px solid #3b82f6;
    }

    .div_use_guide {
        background-color: #f5f5f5;
        padding: 10px 16px;
        text-align: left;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        font-weight: bold;
    }

    .btn_more {
        border: 1px solid #e0e0e0;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
</style>

<body>
<div class="main-container shadow-2xl items-center w-full max-w-md min-h-screen mx-auto">

    <!-- Header -->
    <th:block th:replace="~{includes/user/header_page}" />
    <script>$("#h1_header_page_title").html("프로필 설정");</script>

    <!-- Main Content -->
    <div>
        <!-- Current Balance -->
        <div class="prediction-card m-4">
            <div class="max-w-md mx-auto bg-white rounded-lg shadow-sm p-4">
                <!-- Profile Header -->
                <div class="flex items-center mb-8">
                    <div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mr-4">
                        <i class="fas fa-user text-2xl text-gray-600"></i>
                    </div>
                    <div class="flex-1">
                        <h1 class="text-lg font-semibold text-gray-900"><span class="font_user_nick">-</span></h1>
                    </div>
                </div>

                <!-- Form Fields -->
                <form class="space-y-6">
                    <input type="hidden" id="detail_user_id" />
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">*닉네임</label>
                        <div class="flex gap-2">
                            <input type="text" id="detail_user_nick" name="nick" placeholder="내용을 입력해주세요" class="input_param flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <button type="button" onclick="duplicate_nick()" class="px-4 py-2 text-sm text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">중복 확인</button>
                            <input type="hidden" id="detail_user_nick_backup" />
                        </div>
                        <div class="text-xs text-gray-500">최대 20자</div>
                    </div>

                    <!-- 이메일 -->
                    <!--<div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">이메일</label>
                        <input type="email" value="johnkim@email.com" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>-->

                    <!-- 출생연도 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">출생연도</label>
                        <select id="detail_user_birthyear" name="birthyear" class="input_param input_required w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="출생연도를 선택하세요.">
                            <option value="">선택하세요</option>
                        </select>
                        <script>
                            //let `${index}
                            for(let i=1950;i<2025;i++){
                                $("#detail_user_birthyear").append(`<option value="${i}">${i}년</option>`);
                            }
                        </script>
                    </div>

                    <!-- 성별 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-3">성별</label>
                        <div class="flex gap-6">
                            <label class="flex items-center">
                                <input type="radio" id="detail_user_gender_male" name="gender" value="M" class="input_user_gender w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500">
                                <span class="ml-2 text-sm text-gray-700">남성</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" id="detail_user_gender_female" name="gender" value="F" class="input_user_gender w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500">
                                <span class="ml-2 text-sm text-gray-700">여성</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" id="detail_user_gender_other" name="gender" value="E" class="input_user_gender w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500">
                                <span class="ml-2 text-sm text-gray-700">기타</span>
                            </label>
                        </div>
                        <script>
                            $('.input_user_gender').change(function() {
                                let index = $('.input_user_gender').index(this); // 클릭된 버튼의 인덱스
                                let value = $(this).val();
                                //alert(value);
                                $("#detail_user_gender").val(value);
                            });
                        </script>
                        <input type="hidden1" class="hide input_param input_required" name="gender" id="detail_user_gender" placeholder="성별을 선택하세요."/>
                    </div>

                    <!-- 거주 지역 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">거주 지역</label>
                        <select id="detail_user_region" name="region"  class="input_param input_required w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="거주지역을 선택하세요.">
                            <option value="서울특별시">서울특별시</option>
                            <option value="부산광역시">부산광역시</option>
                            <option value="대구광역시">대구광역시</option>
                            <option value="인천광역시">인천광역시</option>
                            <option value="광주광역시">광주광역시</option>
                            <option value="대전광역시">대전광역시</option>
                            <option value="울산광역시">울산광역시</option>
                            <option value="세종특별자치시">세종특별자치시</option>
                            <option value="경기도">경기도</option>
                            <option value="강원특별자치도">강원특별자치도</option>
                            <option value="충청북도">충청북도</option>
                            <option value="충청남도">충청남도</option>
                            <option value="전북특별자치도">전북특별자치도</option>
                            <option value="전라남도">전라남도</option>
                            <option value="경상북도">경상북도</option>
                            <option value="경상남도">경상남도</option>
                            <option value="제주특별자치도">제주특별자치도</option>
                            <option value="해외">해외</option>
                        </select>
                        <!--<input type="text" id="detail_user_region" name="region" placeholder="거주 지역을 입력해주세요" class="input_param w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">-->
                    </div>

                    <!-- 휴대폰 번호 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">휴대폰 번호</label>
                        <div class="flex gap-2">
                            <input type="tel" id="detail_user_phone" placeholder="휴대폰 번호 입력" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" disabled="disabled">
                        </div>
                        <div class="text-xs text-gray-500">수정 불가</div>
                    </div>
                </form>

            </div>
        </div>

        <div class="p-4">
            <!-- 정보 수정 완료 버튼 -->
            <button type="submit" class="w-full py-3 text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium" onclick="update_user()">
                수정하기
            </button>
            <!-- Additional Actions -->
            <div class="mt-8 pt-4 border-t border-gray-200">
                <div class="space-y-3">
                    <div class="flex justify-center space-x-6 pt-1">
                        <button type="button" class="text-sm text-gray-600 hover:text-gray-800 focus:outline-none" onclick="user_logout()">
                            로그아웃
                        </button>
                        <!--<button type="button" class="text-sm text-gray-400 hover:text-gray-600 focus:outline-none">
                            계정 탈퇴
                        </button>-->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <th:block th:replace="~{includes/user/footer}" />
    <script>listener_bottom_navi(3);</script>
</div>
<th:block th:replace="~{includes/user/bottom}" />
<script>
    $(document).ready(function () {
        console.log("ready!");
        detail_user();
    });
    function detail_user() {
        let userId = 0;
        let _data = new Map();
        _data.url = "/api/user";
        _data.type = "GET";
        _data.param = {id: userId};
        _data.success = function (obj_data, obj_status, obj_xhr) {
            //alert(JSON.stringify(obj_data));
            listenerAfterDetail(obj_data, "user");
            $("#detail_user_nick_backup").val(obj_data["nick"]);
            $('input[name="gender"][value="'+obj_data["gender"]+'"]').prop('checked', true);
        }
        _data.error = function (obj_data, obj_status, obj_xhr) {
            alert("정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
        }
        func_ajax(_data);
    }
    function duplicate_nick() {
        let _data = new Map();
        _data.url = "/api/user/nick";
        _data.type = "POST";
        _data.param = {
            nick : $("#detail_user_nick").val()
        };
        _data.success = function (obj_data, obj_status, obj_xhr) {
            //alert(JSON.stringify(obj_data));
            if(obj_data){
                alert("사용 가능합니다.");
            } else {
                alert("이미 사용중인 닉네임 입니다.");
                $("#detail_user_nick").val($("#detail_user_nick_backup").val());
            }
        }
        _data.error = function (obj_data, obj_status, obj_xhr) {
            alert("정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
        }
        func_ajax(_data);
    }
    function update_user(){
        if(!listenerBeforeCreate()){
            return false;
        }

        let userId = 0;
        let _param = listenerCreateParam();
        _param["id"] = userId;

        let _data = {};
        _data.url = "/api/user";
        _data.type = "PUT";
        _data.param = _param;
        _data.success = function(obj_data, obj_status, obj_xhr){
            alert("정상 처리 되었습니다.");
            detail_user();
        }
        _data.error = function(obj_data, obj_status, obj_xhr){
            alert("정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
        }
        func_ajax(_data);
    }
    function user_logout(){
        localStorage_clear();
        location.replace("/index");
    }
</script>
</body>
</html>